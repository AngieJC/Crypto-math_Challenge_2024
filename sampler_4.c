/*
 * @Author: AngieJC htk90uggk@outlook.com
 * @Date: 2024-05-06 22:34:47
 * @LastEditors: AngieJC htk90uggk@outlook.com
 * @LastEditTime: 2024-05-14 20:29:46
 * @FilePath: /Crypto-math_Challenge_2024/sampler_4.c
 */
#include "my_sampler.h"

static int sampler_base_4_1_6(prng *__restrict rng){
    static const uint8_t m4_index_1_6[56][10] = {
        {2, 3, 5, 0, 0, 0, 0, 0, 0, 0}, {2, 4, 5, 0, 0, 0, 0, 0, 0, 0}, {0, 4, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {3, 4, 6, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 2, 3, 4, 0, 0, 0, 0, 0}, {0, 1, 3, 4, 5, 6, 0, 0, 0, 0}, 
        {0, 3, 5, 6, 0, 0, 0, 0, 0, 0}, {1, 4, 6, 7, 0, 0, 0, 0, 0, 0}, {0, 1, 7, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 2, 3, 4, 7, 0, 0, 0, 0, 0}, {0, 1, 2, 5, 0, 0, 0, 0, 0, 0}, {1, 3, 4, 6, 7, 8, 0, 0, 0, 0}, 
        {0, 1, 2, 3, 5, 6, 8, 0, 0, 0}, {1, 2, 3, 4, 6, 0, 0, 0, 0, 0}, {0, 4, 5, 6, 7, 0, 0, 0, 0, 0}, 
        {4, 5, 7, 0, 0, 0, 0, 0, 0, 0}, {1, 2, 3, 4, 5, 6, 8, 9, 0, 0}, {0, 3, 5, 8, 9, 0, 0, 0, 0, 0}, 
        {0, 1, 2, 4, 5, 6, 7, 8, 9, 0}, {1, 3, 4, 6, 7, 8, 0, 0, 0, 0}, {0, 3, 7, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 1, 5, 6, 8, 9, 0, 0, 0, 0}, {3, 5, 9, 0, 0, 0, 0, 0, 0, 0}, {3, 5, 7, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 1, 2, 3, 4, 5, 7, 8, 9, 0}, {0, 3, 4, 5, 8, 9, 0, 0, 0, 0}, {4, 5, 6, 9, 0, 0, 0, 0, 0, 0}, 
        {2, 4, 6, 0, 0, 0, 0, 0, 0, 0}, {1, 5, 6, 8, 0, 0, 0, 0, 0, 0}, {0, 2, 5, 6, 7, 9, 0, 0, 0, 0}, 
        {0, 2, 4, 5, 6, 7, 8, 9, 0, 0}, {1, 2, 5, 6, 0, 0, 0, 0, 0, 0}, {1, 6, 9, 0, 0, 0, 0, 0, 0, 0}, 
        {1, 4, 5, 8, 0, 0, 0, 0, 0, 0}, {1, 2, 3, 4, 5, 6, 0, 0, 0, 0}, {0, 1, 2, 3, 4, 5, 8, 9, 0, 0}, 
        {2, 8, 0, 0, 0, 0, 0, 0, 0, 0}, {4, 5, 6, 7, 8, 9, 0, 0, 0, 0}, {1, 2, 3, 4, 5, 6, 7, 0, 0, 0}, 
        {3, 4, 6, 7, 0, 0, 0, 0, 0, 0}, {1, 2, 3, 5, 6, 7, 8, 0, 0, 0}, {3, 4, 6, 7, 0, 0, 0, 0, 0, 0}, 
        {1, 3, 4, 6, 7, 8, 9, 0, 0, 0}, {0, 2, 4, 6, 7, 8, 9, 0, 0, 0}, {2, 5, 9, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 2, 4, 8, 9, 0, 0, 0, 0, 0}, {4, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {3, 9, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {6, 8, 9, 0, 0, 0, 0, 0, 0, 0}, {5, 6, 7, 8, 9, 0, 0, 0, 0, 0}, {5, 7, 8, 0, 0, 0, 0, 0, 0, 0}, 
        {6, 8, 9, 0, 0, 0, 0, 0, 0, 0}, {5, 7, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {6, 7, 9, 0, 0, 0, 0, 0, 0, 0}, {6, 8, 9, 0, 0, 0, 0, 0, 0, 0}
    };
    static const uint8_t m4_col_sum_1_6[56] = {
        3, 3, 2, 3, 5, 6, 4, 4, 
        3, 5, 4, 6, 7, 5, 5, 3, 
        8, 5, 9, 6, 3, 6, 3, 3, 
        9, 6, 4, 3, 4, 6, 8, 4, 
        3, 4, 6, 8, 2, 6, 7, 4, 
        7, 4, 7, 7, 3, 5, 1, 2, 
        3, 5, 3, 3, 2, 0, 3, 3
    };
    static const int8_t sample_val_1_6[253] = {
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 
        2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 
        3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4
    };
    static uint64_t b64 = 0, cnt = 0;
    int32_t d;
    while(1) {
        uint8_t b8 = prng_get_u8(rng);
        if(__glibc_likely(b8 < 253))
            return sample_val_1_6[b8];
        b8 = ~b8;
        d = b8;
        #if defined __GNUC__
        #pragma GCC unroll 2
        #elif defined __clang__
        #pragma clang loop unroll(2)
        #endif
        for(int col = 0; col < 56; ++col) {
            d = (d << 1) + check_cnt(&cnt, &b64, rng) - m4_col_sum_1_6[col];
            if(d < 0)
                return m4_index_1_6[col][-(d + 1)];
        }
    }
}

static int sampler_base_4_1_2(prng *__restrict rng){
    static const uint8_t m4_index_1_2[56][10] = {
        {0, 2, 3, 0, 0, 0, 0, 0, 0, 0}, {1, 2, 4, 0, 0, 0, 0, 0, 0, 0}, {0, 4, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 2, 3, 4, 0, 0, 0, 0, 0, 0}, {0, 2, 3, 4, 0, 0, 0, 0, 0, 0}, {0, 1, 3, 4, 5, 0, 0, 0, 0, 0}, 
        {0, 2, 4, 0, 0, 0, 0, 0, 0, 0}, {1, 5, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 2, 3, 5, 0, 0, 0, 0, 0, 0}, 
        {0, 1, 3, 4, 0, 0, 0, 0, 0, 0}, {0, 1, 4, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 3, 6, 0, 0, 0, 0, 0, 0}, 
        {0, 1, 2, 3, 4, 5, 6, 0, 0, 0}, {1, 2, 3, 4, 5, 6, 0, 0, 0, 0}, {1, 2, 3, 5, 6, 0, 0, 0, 0, 0}, 
        {1, 4, 6, 0, 0, 0, 0, 0, 0, 0}, {0, 2, 0, 0, 0, 0, 0, 0, 0, 0}, {1, 2, 3, 4, 7, 0, 0, 0, 0, 0}, 
        {1, 6, 0, 0, 0, 0, 0, 0, 0, 0}, {1, 2, 4, 6, 7, 0, 0, 0, 0, 0}, {1, 5, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {2, 3, 4, 7, 0, 0, 0, 0, 0, 0}, {2, 6, 7, 0, 0, 0, 0, 0, 0, 0}, {0, 2, 3, 6, 7, 0, 0, 0, 0, 0}, 
        {1, 2, 3, 4, 5, 7, 0, 0, 0, 0}, {1, 2, 3, 8, 0, 0, 0, 0, 0, 0}, {1, 2, 3, 4, 8, 0, 0, 0, 0, 0}, 
        {1, 8, 0, 0, 0, 0, 0, 0, 0, 0}, {2, 4, 5, 6, 8, 0, 0, 0, 0, 0}, {0, 2, 5, 0, 0, 0, 0, 0, 0, 0}, 
        {4, 6, 8, 0, 0, 0, 0, 0, 0, 0}, {2, 6, 7, 0, 0, 0, 0, 0, 0, 0}, {1, 3, 8, 0, 0, 0, 0, 0, 0, 0}, 
        {6, 9, 0, 0, 0, 0, 0, 0, 0, 0}, {1, 3, 6, 0, 0, 0, 0, 0, 0, 0}, {0, 3, 5, 7, 9, 0, 0, 0, 0, 0}, 
        {2, 3, 6, 8, 0, 0, 0, 0, 0, 0}, {1, 3, 5, 6, 7, 8, 9, 0, 0, 0}, {2, 3, 4, 6, 0, 0, 0, 0, 0, 0}, 
        {1, 2, 3, 5, 7, 8, 9, 0, 0, 0}, {1, 2, 3, 4, 7, 9, 0, 0, 0, 0}, {4, 5, 6, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 1, 3, 5, 8, 9, 0, 0, 0, 0}, {0, 4, 7, 9, 0, 0, 0, 0, 0, 0}, {1, 5, 8, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 1, 2, 3, 5, 7, 8, 9, 0, 0}, {6, 7, 8, 0, 0, 0, 0, 0, 0, 0}, {3, 7, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {5, 7, 8, 9, 0, 0, 0, 0, 0, 0}, {6, 8, 9, 0, 0, 0, 0, 0, 0, 0}, {7, 9, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {6, 7, 0, 0, 0, 0, 0, 0, 0, 0}, {4, 5, 8, 9, 0, 0, 0, 0, 0, 0}, {4, 5, 8, 0, 0, 0, 0, 0, 0, 0}, 
        {7, 9, 0, 0, 0, 0, 0, 0, 0, 0}, {5, 0, 0, 0, 0, 0, 0, 0, 0, 0}
    };
    static const uint8_t m4_col_sum_1_2[56] = {
        3, 3, 2, 4, 4, 5, 3, 2, 
        4, 4, 3, 4, 7, 6, 5, 3, 
        2, 5, 2, 5, 2, 4, 3, 5, 
        6, 4, 5, 2, 5, 3, 3, 3, 
        3, 2, 3, 5, 4, 7, 4, 7, 
        6, 3, 6, 4, 3, 8, 3, 2, 
        4, 3, 2, 2, 4, 3, 2, 1
    };
    static const int8_t sample_val_1_2[253] = {
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 
        2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3
    };
    static uint64_t b64 = 0, cnt = 0;
    int32_t d;
    while(1) {
        uint8_t b8 = prng_get_u8(rng);
        if(__glibc_likely(b8 < 253))
            return sample_val_1_2[b8];
        b8 = ~b8;
        d = b8;
        #if defined __GNUC__
        #pragma GCC unroll 2
        #elif defined __clang__
        #pragma clang loop unroll(2)
        #endif
        for(int col = 0; col < 56; ++col) {
            d = (d << 1) + check_cnt(&cnt, &b64, rng) - m4_col_sum_1_2[col];
            if(d < 0)
                return m4_index_1_2[col][-(d + 1)];
        }
    }
}

static int sampler_base_4_1_0(prng *__restrict rng){
    static const uint8_t m4_index_1_0[56][10] = {
        {1, 2, 3, 0, 0, 0, 0, 0, 0, 0}, {2, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {3, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {1, 3, 4, 0, 0, 0, 0, 0, 0, 0}, {1, 3, 4, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 1, 2, 3, 0, 0, 0, 0, 0, 0}, {1, 3, 0, 0, 0, 0, 0, 0, 0, 0}, {2, 4, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {3, 5, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 2, 3, 0, 0, 0, 0, 0, 0}, 
        {0, 1, 2, 3, 4, 0, 0, 0, 0, 0}, {1, 2, 3, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 5, 0, 0, 0, 0, 0, 0, 0}, 
        {0, 4, 5, 0, 0, 0, 0, 0, 0, 0}, {4, 5, 0, 0, 0, 0, 0, 0, 0, 0}, {1, 2, 3, 4, 0, 0, 0, 0, 0, 0}, 
        {1, 3, 4, 5, 6, 0, 0, 0, 0, 0}, {0, 4, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 3, 4, 5, 0, 0, 0, 0, 0}, 
        {3, 4, 6, 0, 0, 0, 0, 0, 0, 0}, {1, 4, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 2, 6, 0, 0, 0, 0, 0, 0}, 
        {1, 2, 4, 5, 0, 0, 0, 0, 0, 0}, {0, 1, 5, 6, 0, 0, 0, 0, 0, 0}, {1, 2, 3, 5, 0, 0, 0, 0, 0, 0}, 
        {1, 4, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 3, 4, 5, 6, 7, 0, 0, 0}, {1, 3, 4, 6, 7, 0, 0, 0, 0, 0}, 
        {1, 2, 3, 4, 6, 7, 0, 0, 0, 0}, {1, 3, 4, 5, 0, 0, 0, 0, 0, 0}, {3, 5, 6, 0, 0, 0, 0, 0, 0, 0}, 
        {1, 4, 5, 6, 7, 0, 0, 0, 0, 0}, {0, 1, 2, 3, 5, 0, 0, 0, 0, 0}, {1, 2, 3, 4, 7, 0, 0, 0, 0, 0}, 
        {0, 2, 4, 6, 7, 0, 0, 0, 0, 0}, {0, 1, 3, 4, 5, 0, 0, 0, 0, 0}, {3, 4, 5, 6, 7, 8, 0, 0, 0, 0}, 
        {2, 5, 7, 0, 0, 0, 0, 0, 0, 0}, {0, 4, 5, 6, 7, 0, 0, 0, 0, 0}, {0, 2, 3, 4, 5, 6, 7, 0, 0, 0}, 
        {0, 6, 7, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 2, 0, 0, 0, 0, 0, 0, 0}, {2, 4, 5, 6, 7, 8, 0, 0, 0, 0}, 
        {2, 4, 0, 0, 0, 0, 0, 0, 0, 0}, {2, 5, 6, 0, 0, 0, 0, 0, 0, 0}, {4, 7, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {3, 7, 0, 0, 0, 0, 0, 0, 0, 0}, {6, 7, 8, 0, 0, 0, 0, 0, 0, 0}, {3, 4, 8, 0, 0, 0, 0, 0, 0, 0}, 
        {4, 6, 8, 9, 0, 0, 0, 0, 0, 0}, {6, 7, 8, 9, 0, 0, 0, 0, 0, 0}, {6, 0, 0, 0, 0, 0, 0, 0, 0, 0}, 
        {4, 5, 6, 9, 0, 0, 0, 0, 0, 0}, {4, 6, 9, 0, 0, 0, 0, 0, 0, 0}
    };
    static const uint8_t m4_col_sum_1_0[56] = {
        3, 1, 0, 1, 3, 3, 4, 2, 
        2, 1, 2, 4, 5, 3, 3, 3, 
        2, 4, 5, 2, 5, 3, 2, 4, 
        4, 4, 4, 2, 7, 5, 6, 4, 
        3, 5, 5, 5, 5, 5, 6, 3, 
        5, 7, 3, 3, 6, 2, 3, 2, 
        2, 3, 3, 4, 4, 1, 4, 3
    };
    static const int8_t sample_val_1_0[254] = {
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3
    };
    static uint64_t b64 = 0, cnt = 0;
    int32_t d;
    while(1) {
        uint8_t b8 = prng_get_u8(rng);
        if(__glibc_likely(b8 < 254))
            return sample_val_1_0[b8];
        b8 = ~b8;
        d = b8;
        #if defined __GNUC__
        #pragma GCC unroll 2
        #elif defined __clang__
        #pragma clang loop unroll(2)
        #endif
        for(int col = 0; col < 56; ++col) {
            d = (d << 1) + check_cnt(&cnt, &b64, rng) - m4_col_sum_1_0[col];
            if(d < 0)
                return m4_index_1_0[col][-(d + 1)];
        }
    }
}

inline static int accept_sample(double p, prng *__restrict rng) {
    uint64_t i = 1;
    uint8_t u, v;
    do {
        i <<= 8;
        u = prng_get_u8(rng);
        v = (uint64_t)(p * i) & 0xff;
    } while (__glibc_unlikely(u == v));
    return u < v;
}

// sigma is uniformly distributed over (0.8,1.6) and center is uniformly distributed over [0,1)
int sampler_4(void *ctx, double sigma, double center){
    prng *restrict rng = &((sampler_context *)ctx)->p;
    static double subtracted_numbers_1_6[] = {0.0, 0.19531249999999997, 0.7812499999999999, 1.7578124999999996, 3.1249999999999996, 4.882812499999999, 7.031249999999998, 9.570312499999998, 12.499999999999998, 15.820312499999996};
    static double subtracted_numbers_1_2[] = {0.0, 0.3472222222222222, 1.3888888888888888, 3.125, 5.555555555555555, 8.680555555555555, 12.5, 17.01388888888889, 22.22222222222222, 28.125};
    static double subtracted_numbers_1_0[] = {0.0, 0.5, 2.0, 4.5, 8.0, 12.5, 18.0, 24.5, 32.0, 40.5};

    while(1) {
        if(sigma <= 1.0) {
            uint8_t z0 = sampler_base_4_1_0(rng);
            int8_t z = (prng_get_u8(rng) & 1) ? z0 + 1 : -z0;
            double x = subtracted_numbers_1_0[z0]
                        - (double)((z - center) * (z - center)) / (2 * sigma * sigma);
            if(accept_sample(my_exp(x) * 0.8 / sigma, rng))
                return z;
        }
        else if(sigma <= 1.2) {
            uint8_t z0 = sampler_base_4_1_2(rng);
            int8_t z = (prng_get_u8(rng) & 1) ? z0 + 1 : -z0;
            double x = subtracted_numbers_1_2[z0]
                        - (double)((z - center) * (z - center)) / (2 * sigma * sigma);
            if(accept_sample(my_exp(x) / sigma, rng))
                return z;
        }
        else {
            uint8_t z0 = sampler_base_4_1_6(rng);
            int8_t z = (prng_get_u8(rng) & 1) ? z0 + 1 : -z0;
            double x = subtracted_numbers_1_6[z0]
                        - (double)((z - center) * (z - center)) / (2 * sigma * sigma);
            if(accept_sample(my_exp(x) * 1.2 / sigma, rng))
                return z;
        }
    }

    return 0;
}